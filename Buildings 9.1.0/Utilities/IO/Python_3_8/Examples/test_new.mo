within Buildings.Utilities.IO.Python_3_8.Examples;
model test_new "test python envKalman filter implemented in Python and called from Modelica"
  extends Modelica.Icons.Example;
parameter Modelica.Units.SI.Time samplePeriod=800
    "Sample period of component";
  Real_Real            ran(
    nDblWri=1,
    nDblRea=1,
    functionName="random",
    moduleName="GroundHX",
    samplePeriod=samplePeriod,
    passPythonObject=true) "Generate a random number in Python"
    annotation (Placement(transformation(extent={{44,-52},{64,-32}})));

  Modelica.Blocks.Sources.CombiTimeTable combiTimeTable(
    tableOnFile=true,
    table=[0,14,74.5,44.9,11.3,38.4,35.3; 1,13.9,74.5,44.9,9.9,38.2,35.4; 2,14,74.5,
        44.9,11.2,38.3,35.7; 3,13.9,74.5,45,9.8,38.4,35.4; 4,14,74.5,45,11.2,38.6,
        35.6; 5,14,74.5,45,9.8,38.4,35.7; 6,14.1,74.5,45,11.2,38.3,35.5; 7,13.9,
        74.5,45.1,9.7,38.4,35.1; 8,14,74.5,45.1,11.1,38.5,35.5; 9,13.9,74.5,45.1,
        10,38.2,35.4; 10,14,74.5,45.1,11.1,38.5,35.1; 11,13.9,74.5,45.1,10.4,38.7,
        35.3; 12,14.1,74.5,45.2,11.1,38.7,35.3; 13,13.9,74.5,45.2,10.2,38.6,35.6;
        14,14.1,74.5,45.2,11,38.3,35.4; 15,13.7,74.5,45.2,11.4,38.5,35.3; 16,14.1,
        74.5,45.3,10.8,38.5,35.2; 17,13.7,74.5,45.3,11.7,38.3,35.2; 18,14.1,74.5,
        45.3,10.9,38.5,36.2; 19,14,74.5,45.3,11,38.2,35.5; 20,14.1,74.5,45.3,11,
        38.1,35.9; 21,14.1,74.5,45.4,10.8,38.7,35.6; 22,14.1,74.5,45.4,10.7,38.3,
        35.8; 23,14.2,74.5,45.4,11.6,38.9,35.7; 24,14.1,74.5,45.4,10.5,37.8,35.9;
        25,14.1,74.5,45.4,11.5,38.3,36; 26,14.1,74.5,45.5,10.4,38.2,35.7; 27,14.2,
        74.5,45.5,11.5,37.8,35.7; 28,14.1,74.5,45.5,10.2,38.3,35.4; 29,14,74.5,40.8,
        11.3,38,35.9; 30,13.1,74.5,43.1,9.9,38.3,35.8; 31,12.5,74.5,43.2,11.1,38.2,
        35.8; 32,12.5,74.5,42.9,10.2,38.1,35.5; 33,12.4,74.5,44.2,11.1,38.6,35.3;
        34,12.2,74.5,43.8,10.9,38.4,35.4; 35,12.3,74.5,43.4,10.9,38.5,35.8; 36,12.2,
        74.5,43.6,11.5,38.3,35.3; 37,12.2,74.5,43.6,10.8,38.6,35.4; 38,12.1,74.5,
        44.1,11.6,38.7,35.6; 39,12.2,74.5,44.1,10.6,38.6,35.8; 40,12,74.5,44.7,11.6,
        38.1,35.4; 41,12.2,74.5,44.8,10.4,38.2,36.1; 42,12,74.5,45.1,11.4,37.9,35.8;
        43,12.5,74.5,44.4,10.3,38.6,35.6; 44,12.1,74.5,44,11.4,38.4,35.5; 45,12.3,
        74.5,45.3,10.1,38.2,35; 46,12.3,74.5,45.3,11.3,38.7,35.4; 47,12.4,74.5,45.1,
        10,38.5,35.1; 48,12.5,74.5,44.9,11.3,38.3,35.2; 49,12.5,74.5,44.7,9.9,38.4,
        35.7; 50,12.6,74.5,44.7,11.2,38.7,36; 51,12.5,74.5,44.4,10,38.2,35.9; 52,
        12.6,74.5,43.9,11.2,38.2,35.7; 53,12.7,74.5,43.8,9.8,38.3,35.4; 54,12.6,
        74.5,43.7,11.2,38.2,35.6; 55,12.8,74.5,43.6,9.7,38.3,35.8; 56,12.9,74.5,
        43.8,11.1,38.1,35.6; 57,12.7,74.5,44,10.3,38,35.3; 58,13,74.5,44.4,11,38.6,
        35.6; 59,12.7,74.5,44.7,10.7,38.7,35.6; 60,13,74.5,45.4,10.9,38.3,35.4;
        61,13,74.5,44.7,11.2,38.4,35.8; 62,13.1,74.5,43.8,10.9,38.5,35; 63,12.9,
        74.5,44.1,11.7,38.1,35.7; 64,13.3,74.5,44.6,10.8,38.4,35.7; 65,12.9,74.5,
        45.1,11.7,38.6,35.6; 66,13.2,74.5,45.5,10.7,37.9,35.5; 67,13.1,74.5,45.3,
        11.6,38.4,34.9; 68,13.4,74.5,44.1,10.5,38.4,36.4; 69,13.2,74.5,44.1,11.5,
        38.4,35.7; 70,13.3,74.5,45.3,10.4,38.5,35.5; 71,13.5,74.5,44,11.5,37.9,35.7;
        72,13.4,74.5,45.4,10.4,38.5,35.7; 73,13.3,74.5,43.8,11.5,38.3,35.7; 74,13.3,
        74.5,44.4,10.2,37.8,35.4; 75,13.3,74.5,45.5,11.4,38.6,35.9; 76,13.5,74.5,
        43.8,10.1,38.2,35.5; 77,13.4,74.5,44.4,11.3,38.3,35.4; 78,13.3,74.5,45.4,
        9.8,38.3,35.3; 79,13.4,74.5,45.5,11.1,38.3,35.4; 80,13.2,74.5,44.3,10.2,
        38.2,35.5; 81,13.3,74.5,43.7,11.1,38.3,35.8; 82,13.1,74.5,43.8,10.3,38.3,
        35.8; 83,13.4,74.5,44.1,10.9,38.3,35.4; 84,13.1,74.5,44.8,11.7,38.5,36;
        85,13.4,74.5,46.1,10.6,37.7,35.5; 86,13.5,74.5,46,11.6,38.8,35.2; 87,13.5,
        74.5,46,10.4,38.8,35.7; 88,13.6,74.5,46,11.5,38.5,35.9; 89,13.7,74.5,46,
        10.3,38.2,35.4; 90,13.7,74.5,46,11.6,38.3,35.1; 91,13.8,74.5,46,10.6,38.6,
        35.6; 92,13.9,74.5,46,11.7,38.4,35.4; 93,13.8,74.5,46,10.5,38.2,35.8; 94,
        13.9,74.5,46,11.5,38.6,35.3; 95,13.8,74.5,46.1,10.3,38.3,35.9; 96,13.9,74.5,
        46,11.4,38.2,36.1],
    tableName="table",
    fileName=ModelicaServices.ExternalReferences.loadResource("modelica://Buildings/GSHP_input_data.txt"),
    extrapolation=Modelica.Blocks.Types.Extrapolation.Periodic,
    timeScale=900)
    annotation (Placement(transformation(extent={{-80,-22},{-60,-2}})));

  Time.ModelTime                     modTim "Model time"
    annotation (Placement(transformation(extent={{-80,-66},{-60,-46}})));
  Modelica.Blocks.Routing.Multiplex3 multiplex3_1
    annotation (Placement(transformation(extent={{-28,-52},{-8,-32}})));
equation
  connect(modTim.y, multiplex3_1.u3[1]) annotation (Line(points={{-59,-56},{-38,
          -56},{-38,-49},{-30,-49}}, color={0,0,127}));
  connect(combiTimeTable.y[1], multiplex3_1.u1[1]) annotation (Line(points={{-59,
          -12},{-38,-12},{-38,-35},{-30,-35}}, color={0,0,127}));
  connect(combiTimeTable.y[1], multiplex3_1.u2[1]) annotation (Line(points={{-59,
          -12},{-38,-12},{-38,-42},{-30,-42}}, color={0,0,127}));
  connect(multiplex3_1.y[1], ran.uR[1])
    annotation (Line(points={{-7,-42},{42,-42}}, color={0,0,127}));
  annotation (Icon(coordinateSystem(preserveAspectRatio=false)), Diagram(
        coordinateSystem(preserveAspectRatio=false)));
end test_new;
